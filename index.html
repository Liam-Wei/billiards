<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ¡Œçƒè¿½åˆ†è®°åˆ†ç‰Œ - ä¿®æ­£ç‰ˆ</title>
    <style>
        /* å…¨å±€é‡ç½® */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #f0f2f5;
            color: #333;
            padding: 15px;
            max-width: 600px; /* æ¨¡æ‹Ÿæ‰‹æœºå®½åº¦ */
            margin: 0 auto;
        }

        /* --- é¡¶éƒ¨åŒºåŸŸ --- */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            position: relative;
        }

        .title {
            font-size: 20px;
            font-weight: bold;
        }

        /* ã€ä¿®æ”¹ç‚¹ï¼šå³ä¸Šè§’å®æ—¶æ’å/åˆ†æ•°ã€‘ */
        .top-rank-display {
            position: absolute;
            right: 0;
            top: 0;
            text-align: right;
            line-height: 1.2;
        }
        .top-rank-display .label {
            font-size: 12px;
            color: #888;
            display: block;
        }
        .top-rank-display .score {
            /* å­—ä½“åŠ å¤§ã€åŠ ç²—ã€é¢œè‰²é†’ç›® */
            font-size: 32px; 
            font-weight: 900;
            color: #ff4500; /* æ©™çº¢è‰² */
            text-shadow: 1px 1px 0px rgba(255,255,255,1);
        }

        /* --- è®°åˆ†ç‰ŒåŒºåŸŸ --- */
        .scoreboard {
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            color: white;
            border-radius: 12px;
            padding: 20px;
            display: flex;
            justify-content: space-around;
            align-items: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            margin-bottom: 15px;
        }
        .player { text-align: center; }
        .p-name { font-size: 16px; opacity: 0.9; margin-bottom: 5px; }
        .p-score { font-size: 48px; font-weight: bold; }

        /* --- ã€ä¿®æ”¹ç‚¹ï¼šå›åˆæ•°å±…ä¸­ã€‘ --- */
        .round-info {
            text-align: center; /* ç¡®ä¿æ–‡å­—æ°´å¹³å±…ä¸­ */
            font-size: 18px;
            font-weight: 600;
            color: #555;
            margin: 10px 0;
            padding: 8px;
            background: #fff;
            border-radius: 8px;
        }

        /* --- æ“ä½œæŒ‰é’®åŒº (æ¨¡æ‹Ÿ) --- */
        .controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 20px;
        }
        button {
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            background: #007aff;
            color: white;
        }
        button.action-btn { background: #34c759; }
        button.copy-btn { background: #5856d6; grid-column: span 2; }

        /* --- ã€ä¿®æ”¹ç‚¹ï¼šæ—¥å¿—åˆ—è¡¨ UIã€‘ --- */
        .log-section {
            margin-top: 20px;
        }
        .log-header {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 8px;
            color: #666;
        }
        
        .log-list {
            display: flex;
            flex-direction: column;
            /* ç´§å‡‘é—´è·ï¼šè®¾ä¸º 6px */
            gap: 6px; 
        }

        .log-card {
            background: white;
            border-left: 5px solid #007aff;
            border-radius: 6px;
            /* ç´§å‡‘å†…è¾¹è· */
            padding: 12px 10px; 
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
            
            /* å­—ä½“åŠ å¤§ */
            font-size: 17px; 
            font-weight: 500;
            display: flex;
            justify-content: space-between;
        }
        .log-time { color: #999; font-size: 14px; margin-right: 10px; font-weight: normal;}
    </style>
</head>
<body>

    <div class="header">
        <div class="title">ğŸ± è¿½åˆ†æˆ˜æŠ¥</div>
        
        <div class="top-rank-display">
            <span class="label">å½“å‰æœ€é«˜</span>
            <span class="score" id="topScoreDisplay">0</span>
        </div>
    </div>

    <div class="scoreboard">
        <div class="player">
            <div class="p-name">é€‰æ‰‹ A</div>
            <div class="p-score" id="scoreA">0</div>
        </div>
        <div class="vs">VS</div>
        <div class="player">
            <div class="p-name">é€‰æ‰‹ B</div>
            <div class="p-score" id="scoreB">0</div>
        </div>
    </div>

    <div class="round-info">
        â±ï¸ æ—¶é•¿: <span id="timer">00:00</span> | ğŸ”„ å›åˆ: <span id="roundCount">0</span>
    </div>

    <div class="controls">
        <button onclick="addScore('A', 1)">A +1åˆ† (æ™®èƒœ)</button>
        <button onclick="addScore('B', 1)">B +1åˆ† (æ™®èƒœ)</button>
        <button class="action-btn" onclick="addStats('A', 'breakRun')">A ç‚¸æ¸… (+3)</button>
        <button class="action-btn" onclick="addStats('B', 'runOut')">B æ¥æ¸… (+2)</button>
        
        <button class="copy-btn" onclick="copyReport()">ğŸ“‹ å¤åˆ¶å®Œæ•´æˆ˜æŠ¥</button>
    </div>

    <div class="log-section">
        <div class="log-header">æœ€è¿‘èµ›å†µ (ä»…æ˜¾ç¤ºè¿‘5æ¡)</div>
        <div class="log-list" id="logContainer">
            </div>
    </div>

    <script>
        // --- 1. æ•°æ®çŠ¶æ€ ---
        let scoreA = 0;
        let scoreB = 0;
        let rounds = 0;
        let startTime = Date.now();
        let logs = []; // å­˜å‚¨æ‰€æœ‰æ—¥å¿—

        // ç»Ÿè®¡æ•°æ® (ç”¨äºæˆ˜å±€ç»“ç®—)
        let stats = {
            A: { wins: 0, breakRun: 0, runOut: 0 },
            B: { wins: 0, breakRun: 0, runOut: 0 }
        };

        // --- 2. æ ¸å¿ƒé€»è¾‘ ---

        // æ¨¡æ‹ŸåŠ åˆ†/äº‹ä»¶
        function addScore(player, points) {
            if(player === 'A') scoreA += points;
            if(player === 'B') scoreB += points;
            rounds++;
            
            // è®°å½•ç®€å•çš„èƒœå±€ (æ™®èƒœ)
            if(points === 1) stats[player].wins++;

            addLog(player, `æ™®èƒœè·å¾— ${points} åˆ†`);
            updateUI();
        }

        // æ¨¡æ‹Ÿç‰¹æ®Šäº‹ä»¶ (ç‚¸æ¸…/æ¥æ¸…)
        function addStats(player, type) {
            let points = 0;
            let desc = "";

            if(type === 'breakRun') {
                stats[player].breakRun++;
                points = 3; 
                desc = "ç‚¸æ¸… (Break Run)";
            } else if (type === 'runOut') {
                stats[player].runOut++;
                points = 2;
                desc = "æ¥æ¸… (Run Out)";
            }
            
            if(player === 'A') scoreA += points;
            if(player === 'B') scoreB += points;
            rounds++;

            addLog(player, `${desc} +${points}åˆ†`);
            updateUI();
        }

        // æ·»åŠ æ—¥å¿—
        function addLog(player, action) {
            const now = new Date();
            const timeStr = `${now.getHours().toString().padStart(2,'0')}:${now.getMinutes().toString().padStart(2,'0')}`;
            
            logs.push({
                time: timeStr,
                player: player === 'A' ? 'é€‰æ‰‹A' : 'é€‰æ‰‹B',
                action: action,
                detail: `${player === 'A' ? 'é€‰æ‰‹A' : 'é€‰æ‰‹B'} ${action}` // å®Œæ•´æè¿°
            });
        }

        // æ›´æ–°ç•Œé¢
        function updateUI() {
            document.getElementById('scoreA').innerText = scoreA;
            document.getElementById('scoreB').innerText = scoreB;
            document.getElementById('roundCount').innerText = rounds;

            // æ›´æ–°å³ä¸Šè§’æœ€é«˜åˆ†
            const maxScore = Math.max(scoreA, scoreB);
            document.getElementById('topScoreDisplay').innerText = maxScore;

            // --- å…³é”®ä¿®æ”¹ï¼šæ—¥å¿—æ¸²æŸ“ (åªå–æœ€å5æ¡ + å€’åº) ---
            const logContainer = document.getElementById('logContainer');
            logContainer.innerHTML = ''; // æ¸…ç©º

            // æˆªå–æœ€å5æ¡ï¼Œå¹¶åè½¬ï¼ˆè®©æœ€æ–°çš„åœ¨æœ€ä¸Šé¢ï¼‰
            const recentLogs = logs.slice(-5).reverse();

            recentLogs.forEach(log => {
                const div = document.createElement('div');
                div.className = 'log-card';
                // å­—ä½“åŠ å¤§ï¼Œç»“æ„æ¸…æ™°
                div.innerHTML = `
                    <span>${log.detail}</span>
                    <span class="log-time">${log.time}</span>
                `;
                logContainer.appendChild(div);
            });
        }

        // è®¡æ—¶å™¨
        setInterval(() => {
            const diff = Math.floor((Date.now() - startTime) / 1000);
            const m = Math.floor(diff / 60).toString().padStart(2, '0');
            const s = (diff % 60).toString().padStart(2, '0');
            document.getElementById('timer').innerText = `${m}:${s}`;
        }, 1000);

        // --- 3. æ ¸å¿ƒä¿®å¤ï¼šå¤åˆ¶æˆ˜æŠ¥åŠŸèƒ½ ---
        function copyReport() {
            // è·å–å½“å‰æ—¶é•¿
            const durationText = document.getElementById('timer').innerText;

            let text = "";
            text += `ã€æ¡Œçƒè¿½åˆ†æˆ˜æŠ¥ã€‘\n`;
            text += `ğŸ“… æ—¥æœŸï¼š${new Date().toLocaleDateString()}\n`;
            text += `â±ï¸ æ—¶é•¿ï¼š${durationText} | ğŸ”„ å›åˆï¼š${rounds}\n`;
            text += `ğŸ† æ¯”åˆ†ï¼šA [ ${scoreA} : ${scoreB} ] B\n`;
            text += `----------------------\n`;
            
            // ã€ä¿®å¤ç‚¹1ã€‘æ·»åŠ â€œæˆ˜å±€ç»“ç®—â€
            text += `ğŸ“Š ã€æˆ˜å±€ç»“ç®—ã€‘\n`;
            text += `é€‰æ‰‹Aï¼šæ™®èƒœ[${stats.A.wins}] | ç‚¸æ¸…[${stats.A.breakRun}] | æ¥æ¸…[${stats.A.runOut}]\n`;
            text += `é€‰æ‰‹Bï¼šæ™®èƒœ[${stats.B.wins}] | ç‚¸æ¸…[${stats.B.breakRun}] | æ¥æ¸…[${stats.B.runOut}]\n`;
            text += `----------------------\n`;

            // ã€ä¿®å¤ç‚¹2ã€‘æ·»åŠ â€œå®Œæ•´è¯¦æƒ…â€ (ä¸ä»…ä»…æ˜¯æœ€è¿‘5æ¡)
            text += `ğŸ“ ã€æ¯”èµ›è¯¦æƒ…ã€‘\n`;
            if (logs.length === 0) {
                text += `(æš‚æ— è®°å½•)\n`;
            } else {
                // å¤åˆ¶æ—¶é€šå¸¸éœ€è¦æŒ‰ç…§æ—¶é—´æ­£åºï¼Œæˆ–è€…å€’åºï¼Œè¿™é‡ŒæŒ‰å€’åºï¼ˆæœ€æ–°çš„åœ¨ä¸Šé¢ï¼‰
                // å¹¶ä¸”éå†æ‰€æœ‰ logsï¼Œè€Œä¸æ˜¯ sliced çš„ logs
                [...logs].reverse().forEach((log, index) => {
                    text += `${log.time} | ${log.detail}\n`;
                });
            }

            // æ‰§è¡Œå¤åˆ¶ API
            if (navigator.clipboard) {
                navigator.clipboard.writeText(text).then(() => {
                    alert('âœ… å®Œæ•´æˆ˜æŠ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼\nåŒ…å«ç»“ç®—æ•°æ®å’Œæ‰€æœ‰å›åˆè¯¦æƒ…ã€‚');
                }).catch(err => {
                    alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶');
                });
            } else {
                // å…¼å®¹æ—§æµè§ˆå™¨
                const textarea = document.createElement('textarea');
                textarea.value = text;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                alert('âœ… å®Œæ•´æˆ˜æŠ¥å·²å¤åˆ¶ï¼');
            }
        }

        // åˆå§‹åŒ–
        updateUI();

    </script>
</body>
</html>
